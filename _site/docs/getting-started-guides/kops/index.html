
  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  


<!Doctype html>
<html id="docs" class="Support">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href='https://fonts.googleapis.com/css?family=Roboto+Mono' type='text/css'>
    <link rel="stylesheet" href="/css/styles.css"/>
    <link rel="stylesheet" href="/css/jquery-ui.min.css">
    <link rel="stylesheet" href="/css/sweetalert.css">
    
    <script src="/js/jquery-2.2.0.min.js"></script>
    <script src="/js/jquery-ui.min.js"></script>
    <script src="/js/script.js"></script>
    <script src="/js/sweetalert.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <!-- Begin Jekyll SEO tag v2.1.0 -->
<title>Installing Kubernetes on AWS with kops - Kubernetes</title>
<meta property="og:title" content="Installing Kubernetes on AWS with kops" />
<meta name="description" content="Production-Grade Container Orchestration" />
<meta property="og:description" content="Production-Grade Container Orchestration" />
<link rel="canonical" href="http://localhost:4000/docs/getting-started-guides/kops/" />
<meta property="og:url" content="http://localhost:4000/docs/getting-started-guides/kops/" />
<meta property="og:site_name" content="Kubernetes" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@kubernetesio" />
<script type="application/ld+json">
{"@context": "http://schema.org",
"@type": "WebPage",
"headline": "Installing Kubernetes on AWS with kops",
"description": "Production-Grade Container Orchestration",
"publisher": {"@type": "Organization",
"logo": {"@type": "ImageObject",
"url": "http://localhost:4000/images/favicon.png"}},
"url": "http://localhost:4000/docs/getting-started-guides/kops/"}</script>
<!-- End Jekyll SEO tag -->

</head>


<body>

<div id="cellophane" onclick="kub.toggleMenu()"></div>

<header>
    <a href="/" class="logo"></a>

    <div class="nav-buttons" data-auto-burger="primary">
        <ul class="global-nav">
            <li><a href="/docs/">Documentation</a></li>
            <li><a href="http://blog.kubernetes.io/">Blog</a></li>
            <li><a href="/partners/">Partners</a></li>
            <li><a href="/community/">Community</a></li>
            <li><a href="/case-studies/">Case Studies</a></li>
        </ul>
        <!-- <a href="/docs/" class="button" id="viewDocs" data-auto-burger-exclude>View Documentation</a> -->
        <a href="/docs/tutorials/kubernetes-basics/" class="button" id="tryKubernetes" data-auto-burger-exclude>Try Kubernetes</a>
        <button id="hamburger" onclick="kub.toggleMenu()" data-auto-burger-exclude><div></div></button>
    </div>

    <nav id="mainNav">
        <main data-auto-burger="primary">
        <div class="nav-box">
            <h3><a href="/docs/hellonode/">Get Started</a></h3>
            <p>Ready to get your hands dirty? Build a simple Kubernetes cluster that runs "Hello World" for Node.js.</p>
        </div>
        <div class="nav-box">
            <h3><a href="/docs/">Documentation</a></h3>
            <p>Learn how to use Kubernetes with the use of walkthroughs, samples, and reference documentation. You can even <a href="/editdocs/" data-auto-burger-exclude>help contribute to the docs</a>!</p>
        </div>
        <div class="nav-box">
            <h3><a href="/community/">Community</a></h3>
            <p>If you need help, you can connect with other Kubernetes users and the Kubernetes authors, attend community events, and watch video presentations from around the web.</p>
        </div>
        <div class="nav-box">
            <h3><a href="http://blog.kubernetes.io">Blog</a></h3>
            <p>Read the latest news for Kubernetes and the containers space in general, and get technical how-tos hot off the presses.</p>
        </div>
        </main>
        <main data-auto-burger="primary">
        <div class="left">
            <h5 class="github-invite">Interested in hacking on the core Kubernetes code base?</h5>
            <a href="https://github.com/kubernetes/kubernetes" class="button" data-auto-burger-exclude>View On Github</a>
        </div>

        <div class="right">
            <h5 class="github-invite">Explore the community</h5>
            <div class="social">
                <a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
                <a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
                <a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
                <a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                <a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
                <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
            </div>
        </div>
        <div class="clear" style="clear: both"></div>
        </main>
    </nav>
</header>


<!--  HERO  -->
<section id="hero" class="light-text">
  <h1>Support</h1>
  <h5>Troubleshooting resources, frequently asked questions, and community support channels.</h5>
  <div id="vendorStrip" class="light-text">
    <ul>
      <li><a href="/docs/" >DOCS HOME</a></li>
      <li><a href="/docs/user-guide/" >GUIDES</a></li>
      <li><a href="/docs/tutorials/" >TUTORIALS</a></li>
      <li><a href="/docs/tasks/" >TASKS</a></li>
      <li><a href="/docs/concepts/" >CONCEPTS</a></li>
      <li><a href="/docs/reference/" >REFERENCE</a></li>
      <li><a href="/docs/tools/" >TOOLS</a></li>
      <li><a href="/docs/samples/" >SAMPLES</a></li>
      <li><a href="/docs/troubleshooting/" class="YAH">SUPPORT</a></li>
    </ul>
    <div id="searchBox">
      <input type="text" id="search" placeholder="Search" onkeydown="if (event.keyCode==13) window.location.replace('/docs/search/?q=' + this.value)">
    </div>
  </div>
</section>

<section id="encyclopedia">
  <div id="docsToc">
        <div class="pi-accordion">
        
          
  

    

    
      <a class="item" data-title="Support" href="/docs/troubleshooting/"></a>
    
  

  
    <div class="item" data-title="Troubleshooting">
      <div class="container">
        
  

    

    
      <a class="item" data-title="User Guide" href="/docs/user-guide/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Frequently Asked Questions">
      <div class="container">
        
  

    

    
      <a class="item" data-title="User FAQ" href="https://github.com/kubernetes/kubernetes/wiki/User-FAQ/"></a>
    
  

  

    

    
      <a class="item" data-title="Debugging FAQ" href="https://github.com/kubernetes/kubernetes/wiki/Debugging-FAQ/"></a>
    
  

  

    

    
      <a class="item" data-title="Services FAQ" href="https://github.com/kubernetes/kubernetes/wiki/Services-FAQ/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Contributing to the Kubernetes Docs">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Contributing to the Kubernetes Documentation" href="/editdocs/"></a>
    
  

  

    

    
      <a class="item" data-title="Creating a Documentation Pull Request" href="/docs/contribute/create-pull-request/"></a>
    
  

  

    

    
      <a class="item" data-title="Writing a New Topic" href="/docs/contribute/write-new-topic/"></a>
    
  

  

    

    
      <a class="item" data-title="Staging Your Documentation Changes" href="/docs/contribute/stage-documentation-changes/"></a>
    
  

  

    

    
      <a class="item" data-title="Using Page Templates" href="/docs/contribute/page-templates/"></a>
    
  

  

    

    
      <a class="item" data-title="Reviewing Documentation Issues" href="/docs/contribute/review-issues/"></a>
    
  

  

    

    
      <a class="item" data-title="Documentation Style Guide" href="/docs/contribute/style-guide/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Other Resources">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Kubernetes Issue Tracker on GitHub" href="https://github.com/kubernetes/kubernetes/issues/"></a>
    
  

  

    

    
      <a class="item" data-title="Report a Security Vulnerability" href="/docs/reporting-security-issues/"></a>
    
  

  

    

    
      <a class="item" data-title="Release Notes" href="https://github.com/kubernetes/kubernetes/releases/"></a>
    
  

  

    

    
      <a class="item" data-title="Release Roadmap" href="https://github.com/kubernetes/kubernetes/milestones/"></a>
    
  


      </div>
    </div>
  

  

    

    
      <a class="item" data-title="Deprecation Policy" href="/docs/deprecation-policy.md"></a>
    
  


        
        </div> <!-- /pi-accordion -->
    <button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
  </div> <!-- /docsToc -->

  <div id="docsContent">
        <p><a href="/editdocs#docs/getting-started-guides/kops.md" id="editPageButton">Edit This Page</a></p>

        
          <h1>Installing Kubernetes on AWS with kops</h1>
        

        <style>
li>.highlighter-rouge {position:relative; top:3px;}
</style>

<h2 id="overview">Overview</h2>

<p>This quickstart shows you how to easily install a Kubernetes cluster on AWS.
It uses a tool called <a href="https://github.com/kubernetes/kops"><code class="highlighter-rouge">kops</code></a>.</p>

<p>kops is an opinionated provisioning system:</p>

<ul>
  <li>Fully automated installation</li>
  <li>Uses DNS to identify clusters</li>
  <li>Self-healing: everything runs in Auto-Scaling Groups</li>
  <li>Limited OS support (Debian preferred, Ubuntu 16.04 supported, early support for CentOS &amp; RHEL)</li>
  <li>High-Availability support</li>
  <li>Can directly provision, or generate terraform manifests</li>
</ul>

<p>If your opinions differ from these you may prefer to build your own cluster using <a href="kubeadm">kubeadm</a> as
a building block.  kops builds on the kubeadm work.</p>

<h2 id="creating-a-cluster">Creating a cluster</h2>

<h3 id="15-install-kops">(1/5) Install kops</h3>

<h4 id="requirements">Requirements</h4>

<p>You must have <a href="http://kubernetes.io/docs/getting-started-guides/kubectl/">kubectl</a> installed in order for kops to work.</p>

<h4 id="installation">Installation</h4>

<p>Download kops from the <a href="https://github.com/kubernetes/kops/releases">releases page</a> (it is also easy to build from source):</p>

<p>On MacOS:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>wget https://github.com/kubernetes/kops/releases/download/v1.4.1/kops-darwin-amd64
chmod +x kops-darwin-amd64
mv kops-darwin-amd64 /usr/local/bin/kops
</code></pre>
</div>

<p>On Linux:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>wget https://github.com/kubernetes/kops/releases/download/v1.4.1/kops-linux-amd64
chmod +x kops-linux-amd64
mv kops-linux-amd64 /usr/local/bin/kops
</code></pre>
</div>

<h3 id="25-create-a-route53-domain-for-your-cluster">(2/5) Create a route53 domain for your cluster</h3>

<p>kops uses DNS for discovery, both inside the cluster and so that you can reach the kubernetes API server
from clients.</p>

<p>kops has a strong opinion on the cluster name: it should be a valid DNS name.  By doing so you will
no longer get your clusters confused, you can share clusters with your colleagues unambiguously,
and you can reach them without relying on remembering an IP address.</p>

<p>You can, and probably should, use subdomains to divide your clusters.  As our example we will use
<code class="highlighter-rouge">useast1.dev.example.com</code>.  The API server endpoint will then be <code class="highlighter-rouge">api.useast1.dev.example.com</code>.</p>

<p>A Route53 hosted zone can serve subdomains.  Your hosted zone could be <code class="highlighter-rouge">useast1.dev.example.com</code>,
but also <code class="highlighter-rouge">dev.example.com</code> or even <code class="highlighter-rouge">example.com</code>.  kops works with any of these, so typically
you choose for organization reasons (e.g. you are allowed to create records under <code class="highlighter-rouge">dev.example.com</code>,
but not under <code class="highlighter-rouge">example.com</code>).</p>

<p>Let’s assume you’re using <code class="highlighter-rouge">dev.example.com</code> as your hosted zone.  You create that hosted zone using
the <a href="http://docs.aws.amazon.com/Route53/latest/DeveloperGuide/CreatingNewSubdomain.html">normal process</a>, or
with a command such as <code class="highlighter-rouge">aws route53 create-hosted-zone --name dev.example.com --caller-reference 1</code>.</p>

<p>You must then set up your NS records in the parent domain, so that records in the domain will resolve.  Here,
you would create NS records in <code class="highlighter-rouge">example.com</code> for <code class="highlighter-rouge">dev</code>.  If it is a root domain name you would configure the NS
records at your domain registrar (e.g. <code class="highlighter-rouge">example.com</code> would need to be configured where you bought <code class="highlighter-rouge">example.com</code>).</p>

<p>This step is easy to mess up (it is the #1 cause of problems!)  You can double-check that
your cluster is configured correctly if you have the dig tool by running:</p>

<p><code class="highlighter-rouge">dig NS dev.example.com</code></p>

<p>You should see the 4 NS records that Route53 assigned your hosted zone.</p>

<h3 id="35-create-an-s3-bucket-to-store-your-clusters-state">(3/5) Create an S3 bucket to store your clusters state</h3>

<p>kops lets you manage your clusters even after installation.  To do this, it must keep track of the clusters
that you have created, along with their configuration, the keys they are using etc.  This information is stored
in an S3 bucket.  S3 permissions are used to control access to the bucket.</p>

<p>Multiple clusters can use the same S3 bucket, and you can share an S3 bucket between your colleagues that
administer the same clusters - this is much easier than passing around kubecfg files.  But anyone with access
to the S3 bucket will have administrative access to all your clusters, so you don’t want to share it beyond
the operations team.</p>

<p>So typically you have one S3 bucket for each ops team (and often the name will correspond
to the name of the hosted zone above!)</p>

<p>In our example, we chose <code class="highlighter-rouge">dev.example.com</code> as our hosted zone, so let’s pick <code class="highlighter-rouge">clusters.dev.example.com</code> as
the S3 bucket name.</p>

<ul>
  <li>
    <p>Export <code class="highlighter-rouge">AWS_PROFILE</code> (if you need to select a profile for the AWS CLI to work)</p>
  </li>
  <li>
    <p>Create the S3 bucket using <code class="highlighter-rouge">aws s3 mb s3://clusters.dev.example.com</code></p>
  </li>
  <li>
    <p>You can <code class="highlighter-rouge">export KOPS_STATE_STORE=s3://clusters.dev.example.com</code> and then kops will use this location by default. 
 We suggest putting this in your bash profile or similar.</p>
  </li>
</ul>

<h3 id="45-build-your-cluster-configuration">(4/5) Build your cluster configuration</h3>

<p>Run “kops create cluster” to create your cluster configuration:</p>

<p><code class="highlighter-rouge">kops create cluster --zones=us-east-1c useast1.dev.example.com</code></p>

<p>kops will create the configuration for your cluster.  Note that it <em>only</em> creates the configuration, it does
not actually create the cloud resources - you’ll do that in the next step with a <code class="highlighter-rouge">kops update cluster</code>.  This
give you an opportunity to review the configuration or change it.</p>

<p>It prints commands you can use to explore further:</p>

<ul>
  <li>List your clusters with: <code class="highlighter-rouge">kops get cluster</code></li>
  <li>Edit this cluster with: <code class="highlighter-rouge">kops edit cluster useast1.dev.example.com</code></li>
  <li>Edit your node instance group: <code class="highlighter-rouge">kops edit ig --name=useast1.dev.example.com nodes</code></li>
  <li>Edit your master instance group: <code class="highlighter-rouge">kops edit ig --name=useast1.dev.example.com master-us-east-1c</code></li>
</ul>

<p>If this is your first time using kops, do spend a few minutes to try those out!  An instance group is a
set of instances, which will be registered as kubernetes nodes.  On AWS this is implemented via auto-scaling-groups.
You can have several instance groups, for example if you wanted nodes that are a mix of spot and on-demand instances, or
GPU and non-GPU instances.</p>

<h3 id="55-create-the-cluster-in-aws">(5/5) Create the cluster in AWS</h3>

<p>Run “kops update cluster” to create your cluster in AWS:</p>

<p><code class="highlighter-rouge">kops update cluster useast1.dev.example.com --yes</code></p>

<p>That takes a few seconds to run, but then your cluster will likely take a few minutes to actually be ready.
<code class="highlighter-rouge">kops update cluster</code> will be the tool you’ll use whenever you change the configuration of your cluster; it
applies the changes you have made to the configuration to your cluster - reconfiguring AWS or kubernetes as needed.</p>

<p>For example, after you <code class="highlighter-rouge">kops edit ig nodes</code>, then <code class="highlighter-rouge">kops update cluster --yes</code> to apply your configuration, and
sometimes you will also have to <code class="highlighter-rouge">kops rolling-update cluster</code> to roll out the configuration immediately.</p>

<p>Without <code class="highlighter-rouge">--yes</code>, <code class="highlighter-rouge">kops update cluster</code> will show you a preview of what it is going to do.  This is handy
for production clusters!</p>

<h3 id="explore-other-add-ons">Explore other add-ons</h3>

<p>See the <a href="/docs/admin/addons/">list of add-ons</a> to explore other add-ons, including tools for logging, monitoring, network policy, visualization &amp; control of your Kubernetes cluster.</p>

<h2 id="whats-next">What’s next</h2>

<ul>
  <li>Learn more about <a href="/docs/user-guide/walkthrough/">Kubernetes concepts and kubectl in Kubernetes 101</a>.</li>
  <li>Learn about <code class="highlighter-rouge">kops</code> <a href="https://github.com/kubernetes/kops">advanced usage</a></li>
</ul>

<h2 id="cleanup">Cleanup</h2>

<ul>
  <li>To delete you cluster: <code class="highlighter-rouge">kops delete cluster useast1.dev.example.com --yes</code></li>
</ul>

<h2 id="feedback">Feedback</h2>

<ul>
  <li>Slack Channel: <a href="https://kubernetes.slack.com/messages/sig-aws/">#sig-aws</a> has a lot of kops users</li>
  <li><a href="https://github.com/kubernetes/kops/issues">GitHub Issues</a></li>
</ul>



        <p><a href=""><img src="https://kubernetes-site.appspot.com/UA-36037335-10/GitHub/docs/getting-started-guides/kops.md?pixel" alt="Analytics" /></a>
        
		<script type="text/javascript">
	        PDRTJS_settings_8345992 = {
		        "id" : "8345992",
		        "unique_id" : "/docs/getting-started-guides/kops/",
		        "title" : "Installing Kubernetes on AWS with kops",
		        "permalink" : "http://kubernetes.github.io/docs/getting-started-guides/kops/"
	        };
	        (function(d,c,j){if(!document.getElementById(j)){var pd=d.createElement(c),s;pd.id=j;pd.src=('https:'==document.location.protocol)?'https://polldaddy.com/js/rating/rating.js':'http://i0.poll.fm/js/rating/rating.js';s=document.getElementsByTagName(c)[0];s.parentNode.insertBefore(pd,s);}}(document,'script','pd-rating-js'));
		</script>
		<a href="" onclick="window.open('https://github.com/kubernetes/kubernetes.github.io/issues/new?title=Issue%20with%20' +
		window.location.pathname)" class="button issue">Create an Issue</a>
		<a href="/editdocs#docs/getting-started-guides/kops.md" class="button issue">Edit this Page</a>
	
	</div>
</section>

<footer>
	<main class="light-text">
		<nav>
			<a href="/docs/hellonode/">Get Started</a>
			<a href="/docs/">Documentation</a>
			<a href="http://blog.kubernetes.io/">Blog</a>
			<a href="/partners/">Partners</a>
			<a href="/community/">Community</a>
			<a href="/case-studies/">Case Studies</a>
		</nav>
		<div class="social">
			<div>
				<a href="https://twitter.com/kubernetesio" class="twitter"><span>twitter</span></a>
				<a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
				<a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
			</div>
			<div>
				<a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
				<a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
				<a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
			</div>
			<div>
				<a href="//get.k8s.io" class="button">Download K8s</a>
				<a href="https://github.com/kubernetes/kubernetes" class="button">Contribute to the K8s codebase</a>
			</div>
		</div>
		<div id="miceType" class="center">
			&copy; 2017 The Kubernetes Authors | Documentation Distributed under <a href="https://github.com/kubernetes/kubernetes.github.io/blob/master/LICENSE" class="light-text">CC BY 4.0</a>
		</div>
		<div id="miceType" class="center">
			Copyright &copy; 2017 The Linux Foundation&reg;. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our Trademark Usage page: <a href="https://www.linuxfoundation.org/trademark-usage" class="light-text">https://www.linuxfoundation.org/trademark-usage</a>
		</div>
	</main>
</footer>

<button class="flyout-button" onclick="kub.toggleToc()"></button>

<style>
.cse .gsc-control-cse, .gsc-control-cse, {
    padding: 0;
}
  .gsc-control-cse table, .gsc-control-cse-en table {
      margin:0px !important;
  }
  .gsc-above-wrapper-area {
      border-bottom: 0;
  }
</style>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-36037335-10', 'auto');
ga('send', 'pageview');

// hide docs nav area if no nav is present, or if nav only contains a link to the current page
(function () {
    window.addEventListener('DOMContentLoaded', init)

        // play nice with our neighbors
        function init() {
            window.removeEventListener('DOMContentLoaded', init)
                hideNav()
        }

    function hideNav(toc){
        if (!toc) toc = document.querySelector('#docsToc')
            var container = toc.querySelector('.container')

                // container is built dynamically, so it may not be present on the first runloop
                if (container) {
                    if (container.childElementCount === 0 || toc.querySelectorAll('a.item').length === 1) {
                        toc.style.display = 'none'
                            document.getElementById('docsContent').style.width = '100%'
                    }
                } else {
                    requestAnimationFrame(function () {
                        hideNav(toc)
                    })
                }
    }
})();
</script>

<!-- Commenting out AnswerDash for now; we need to work on our list of questions/answers/design first
    <!-- Start of AnswerDash script <script>var AnswerDash;!function(e,t,n,s,a){if(!t.getElementById(s)){var i,r=t.createElement(n),c=t.getElementsByTagName(n)[0];e[a]||(i=e[a]=function(){i.__oninit.push(arguments)},i.__oninit=[]),r.type="text/javascript",r.async=!0,r.src="https://p1.answerdash.com/answerdash.min.js?siteid=756",r.setAttribute("id",s),c.parentNode.insertBefore(r,c)}}(window,document,"script","answerdash-script","AnswerDash");</script> <!-- End of AnswerDash script -->


</body>
</html>
