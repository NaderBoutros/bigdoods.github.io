
  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  

  
    
    

  


<!Doctype html>
<html id="docs" class="Support">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="shortcut icon" type="image/png" href="/images/favicon.png">
    <link href='https://fonts.googleapis.com/css?family=Roboto:400,100,100italic,300,300italic,400italic,500,500italic,700,700italic,900,900italic' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href='https://fonts.googleapis.com/css?family=Roboto+Mono' type='text/css'>
    <link rel="stylesheet" href="/css/styles.css"/>
    <link rel="stylesheet" href="/css/jquery-ui.min.css">
    <link rel="stylesheet" href="/css/sweetalert.css">
    
    <script src="/js/jquery-2.2.0.min.js"></script>
    <script src="/js/jquery-ui.min.js"></script>
    <script src="/js/script.js"></script>
    <script src="/js/sweetalert.min.js"></script>
    <script src="/js/bootstrap.min.js"></script>
    <!-- Begin Jekyll SEO tag v2.1.0 -->
<title>Validation - Kubernetes</title>
<meta property="og:title" content="Validation" />
<meta name="description" content="Production-Grade Container Orchestration" />
<meta property="og:description" content="Production-Grade Container Orchestration" />
<link rel="canonical" href="http://localhost:4000/docs/getting-started-guides/ubuntu/validation/" />
<meta property="og:url" content="http://localhost:4000/docs/getting-started-guides/ubuntu/validation/" />
<meta property="og:site_name" content="Kubernetes" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@kubernetesio" />
<script type="application/ld+json">
{"@context": "http://schema.org",
"@type": "WebPage",
"headline": "Validation",
"description": "Production-Grade Container Orchestration",
"publisher": {"@type": "Organization",
"logo": {"@type": "ImageObject",
"url": "http://localhost:4000/images/favicon.png"}},
"url": "http://localhost:4000/docs/getting-started-guides/ubuntu/validation/"}</script>
<!-- End Jekyll SEO tag -->

</head>


<body>

<div id="cellophane" onclick="kub.toggleMenu()"></div>

<header>
    <a href="/" class="logo"></a>

    <div class="nav-buttons" data-auto-burger="primary">
        <ul class="global-nav">
            <li><a href="/docs/">Documentation</a></li>
            <li><a href="http://blog.kubernetes.io/">Blog</a></li>
            <li><a href="/partners/">Partners</a></li>
            <li><a href="/community/">Community</a></li>
            <li><a href="/case-studies/">Case Studies</a></li>
        </ul>
        <!-- <a href="/docs/" class="button" id="viewDocs" data-auto-burger-exclude>View Documentation</a> -->
        <a href="/docs/tutorials/kubernetes-basics/" class="button" id="tryKubernetes" data-auto-burger-exclude>Try Kubernetes</a>
        <button id="hamburger" onclick="kub.toggleMenu()" data-auto-burger-exclude><div></div></button>
    </div>

    <nav id="mainNav">
        <main data-auto-burger="primary">
        <div class="nav-box">
            <h3><a href="/docs/hellonode/">Get Started</a></h3>
            <p>Ready to get your hands dirty? Build a simple Kubernetes cluster that runs "Hello World" for Node.js.</p>
        </div>
        <div class="nav-box">
            <h3><a href="/docs/">Documentation</a></h3>
            <p>Learn how to use Kubernetes with the use of walkthroughs, samples, and reference documentation. You can even <a href="/editdocs/" data-auto-burger-exclude>help contribute to the docs</a>!</p>
        </div>
        <div class="nav-box">
            <h3><a href="/community/">Community</a></h3>
            <p>If you need help, you can connect with other Kubernetes users and the Kubernetes authors, attend community events, and watch video presentations from around the web.</p>
        </div>
        <div class="nav-box">
            <h3><a href="http://blog.kubernetes.io">Blog</a></h3>
            <p>Read the latest news for Kubernetes and the containers space in general, and get technical how-tos hot off the presses.</p>
        </div>
        </main>
        <main data-auto-burger="primary">
        <div class="left">
            <h5 class="github-invite">Interested in hacking on the core Kubernetes code base?</h5>
            <a href="https://github.com/kubernetes/kubernetes" class="button" data-auto-burger-exclude>View On Github</a>
        </div>

        <div class="right">
            <h5 class="github-invite">Explore the community</h5>
            <div class="social">
                <a href="https://twitter.com/kubernetesio" class="twitter"><span>Twitter</span></a>
                <a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
                <a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
                <a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
                <a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
                <a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
            </div>
        </div>
        <div class="clear" style="clear: both"></div>
        </main>
    </nav>
</header>


<!--  HERO  -->
<section id="hero" class="light-text">
  <h1>Support</h1>
  <h5>Troubleshooting resources, frequently asked questions, and community support channels.</h5>
  <div id="vendorStrip" class="light-text">
    <ul>
      <li><a href="/docs/" >DOCS HOME</a></li>
      <!-- <li><a href="/docs/user-guide/" >GUIDES</a></li> -->
      <li><a href="/docs/tutorials/" >TUTORIALS</a></li>
      <!-- <li><a href="/docs/tasks/" >TASKS</a></li> -->
      <li><a href="/docs/concepts/" >CONCEPTS</a></li>
      <li><a href="/docs/reference/" >REFERENCE</a></li>
      <li><a href="/docs/tools/" >TOOLS</a></li>
      <!-- <li><a href="/docs/samples/" >SAMPLES</a></li> -->
      <li><a href="/docs/troubleshooting/" class="YAH">SUPPORT</a></li>
    </ul>
    <div id="searchBox">
      <input type="text" id="search" placeholder="Search" onkeydown="if (event.keyCode==13) window.location.replace('/docs/search/?q=' + this.value)">
    </div>
  </div>
</section>

<section id="encyclopedia">
  <div id="docsToc">
        <div class="pi-accordion">
        
          
  

    

    
      <a class="item" data-title="Support" href="/docs/troubleshooting/"></a>
    
  

  
    <div class="item" data-title="Troubleshooting">
      <div class="container">
        
  

    

    
      <a class="item" data-title="User Guide" href="/docs/user-guide/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Frequently Asked Questions">
      <div class="container">
        
  

    

    
      <a class="item" data-title="User FAQ" href="https://github.com/kubernetes/kubernetes/wiki/User-FAQ/"></a>
    
  

  

    

    
      <a class="item" data-title="Debugging FAQ" href="https://github.com/kubernetes/kubernetes/wiki/Debugging-FAQ/"></a>
    
  

  

    

    
      <a class="item" data-title="Services FAQ" href="https://github.com/kubernetes/kubernetes/wiki/Services-FAQ/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Contributing to the Kubernetes Docs">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Contributing to the Kubernetes Documentation" href="/editdocs/"></a>
    
  

  

    

    
      <a class="item" data-title="Creating a Documentation Pull Request" href="/docs/contribute/create-pull-request/"></a>
    
  

  

    

    
      <a class="item" data-title="Writing a New Topic" href="/docs/contribute/write-new-topic/"></a>
    
  

  

    

    
      <a class="item" data-title="Staging Your Documentation Changes" href="/docs/contribute/stage-documentation-changes/"></a>
    
  

  

    

    
      <a class="item" data-title="Using Page Templates" href="/docs/contribute/page-templates/"></a>
    
  

  

    

    
      <a class="item" data-title="Reviewing Documentation Issues" href="/docs/contribute/review-issues/"></a>
    
  

  

    

    
      <a class="item" data-title="Documentation Style Guide" href="/docs/contribute/style-guide/"></a>
    
  


      </div>
    </div>
  

  
    <div class="item" data-title="Other Resources">
      <div class="container">
        
  

    

    
      <a class="item" data-title="Kubernetes Issue Tracker on GitHub" href="https://github.com/kubernetes/kubernetes/issues/"></a>
    
  

  

    

    
      <a class="item" data-title="Report a Security Vulnerability" href="/docs/reporting-security-issues/"></a>
    
  

  

    

    
      <a class="item" data-title="Release Notes" href="https://github.com/kubernetes/kubernetes/releases/"></a>
    
  

  

    

    
      <a class="item" data-title="Release Roadmap" href="https://github.com/kubernetes/kubernetes/milestones/"></a>
    
  


      </div>
    </div>
  

  

    

    
      <a class="item" data-title="Deprecation Policy" href="/docs/deprecation-policy.md"></a>
    
  


        
        </div> <!-- /pi-accordion -->
    <button class="push-menu-close-button" onclick="kub.toggleToc()"></button>
  </div> <!-- /docsToc -->

  <div id="docsContent">
        <p><a href="/editdocs#docs/getting-started-guides/ubuntu/validation.md" id="editPageButton">Edit This Page</a></p>

        
          <h1>Validation</h1>
        

        
<p>This page will outline how to ensure that a Juju deployed Kubernetes cluster has stood up correctly and is ready to accept workloads.</p>

<ul id="markdown-toc">
  <li><a href="#before-you-begin" id="markdown-toc-before-you-begin">Before you begin</a></li>
  <li><a href="#validation" id="markdown-toc-validation">Validation</a>    <ul>
      <li><a href="#end-to-end-testing" id="markdown-toc-end-to-end-testing">End to End Testing</a>        <ul>
          <li><a href="#usage" id="markdown-toc-usage">Usage</a></li>
          <li><a href="#running-the-e2e-test" id="markdown-toc-running-the-e2e-test">Running the e2e test</a></li>
          <li><a href="#tuning-the-e2e-test" id="markdown-toc-tuning-the-e2e-test">Tuning the e2e test</a></li>
          <li><a href="#more-information-on-end-to-end-testing" id="markdown-toc-more-information-on-end-to-end-testing">More information on end-to-end testing</a></li>
          <li><a href="#evaluating-end-to-end-results" id="markdown-toc-evaluating-end-to-end-results">Evaluating end-to-end results</a>            <ul>
              <li><a href="#flat-file" id="markdown-toc-flat-file">Flat file</a></li>
              <li><a href="#action-result-output" id="markdown-toc-action-result-output">Action result output</a></li>
            </ul>
          </li>
          <li><a href="#known-issues" id="markdown-toc-known-issues">Known issues</a></li>
        </ul>
      </li>
      <li><a href="#upgrading-the-e2e-tests" id="markdown-toc-upgrading-the-e2e-tests">Upgrading the e2e tests</a></li>
    </ul>
  </li>
</ul>

<h2 id="before-you-begin">Before you begin</h2>

<p>This page assumes you have a working Juju deployed cluster.</p>

<h1 id="validation">Validation</h1>

<h2 id="end-to-end-testing">End to End Testing</h2>

<p>End-to-end (e2e) tests for Kubernetes provide a mechanism to test end-to-end
behavior of the system, and is the last signal to ensure end user operations
match developer specifications. Although unit and integration tests provide a
good signal, in a distributed system like Kubernetes it is not uncommon that a
minor change may pass all unit and integration tests, but cause unforeseen
changes at the system level.</p>

<p>The primary objectives of the e2e tests are to ensure a consistent and reliable
behavior of the kubernetes code base, and to catch hard-to-test bugs before
users do, when unit and integration tests are insufficient.</p>

<h3 id="usage">Usage</h3>

<p>To deploy the end-to-end test suite, you need to relate the <code class="highlighter-rouge">kubernetes-e2e</code> charm to your existing kubernetes-master nodes and easyrsa:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>juju deploy kubernetes-e2e
juju add-relation kubernetes-e2e kubernetes-master
juju add-relation kubernetes-e2e easyrsa
</code></pre>
</div>

<p>Once the relations have settled, you can do <code class="highlighter-rouge">juju status</code> until the workload status results in 
 <code class="highlighter-rouge">Ready to test.</code> - you may then kick off an end to end validation test.</p>

<h3 id="running-the-e2e-test">Running the e2e test</h3>

<p>The e2e test is encapsulated as an action to ensure consistent runs of the
end to end test. The defaults are sensible for most deployments.</p>

<div class="highlighter-rouge"><pre class="highlight"><code>juju run-action kubernetes-e2e/0 test
</code></pre>
</div>

<h3 id="tuning-the-e2e-test">Tuning the e2e test</h3>

<p>The e2e test is configurable. By default it will focus on or skip the declared
conformance tests in a cloud agnostic way. Default behaviors are configurable.
This allows the operator to test only a subset of the conformance tests, or to
test more behaviors not enabled by default. You can see all tunable options on
the charm by inspecting the schema output of the actions:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>juju actions kubernetes-e2e --format=yaml --schema
</code></pre>
</div>

<p>Output:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>test:
  description: Run end-to-end validation test suite
  properties:
    focus:
      default: \[Conformance\]
      description: Regex focus for executing the test
      type: string
    skip:
      default: \[Flaky\]
      description: Regex of tests to skip
      type: string
    timeout:
      default: 30000
      description: Timeout in nanoseconds
      type: integer
  title: test
  type: object
</code></pre>
</div>

<p>As an example, you can run a more limited set of tests for rapid validation of
a deployed cluster. The following example will skip the <code class="highlighter-rouge">Flaky</code>, <code class="highlighter-rouge">Slow</code>, and
<code class="highlighter-rouge">Feature</code> labeled tests:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>juju run-action kubernetes-e2e/0 skip='\[(Flaky|Slow|Feature:.*)\]'
</code></pre>
</div>

<blockquote>
  <p>Note: the escaping of the regex due to how bash handles brackets.</p>
</blockquote>

<p>To see the different types of tests the Kubernetes end-to-end charm has access
to, we encourage you to see the upstream documentation on the different types
of tests, and to strongly understand what subsets of the tests you are running.</p>

<p><a href="https://github.com/kubernetes/kubernetes/blob/master/docs/devel/e2e-tests.md#kinds-of-tests">Kinds of tests</a></p>

<h3 id="more-information-on-end-to-end-testing">More information on end-to-end testing</h3>

<p>Along with the above descriptions, end-to-end testing is a much larger subject
than this readme can encapsulate. There is far more information in the
<a href="https://github.com/kubernetes/kubernetes/blob/master/docs/devel/e2e-tests.md">end-to-end testing guide</a>.</p>

<h3 id="evaluating-end-to-end-results">Evaluating end-to-end results</h3>

<p>It is not enough to just simply run the test. Result output is stored in two
places. The raw output of the e2e run is available in the <code class="highlighter-rouge">juju show-action-output</code>
command, as well as a flat file on disk on the <code class="highlighter-rouge">kubernetes-e2e</code> unit that
executed the test.</p>

<blockquote>
  <p>Note: The results will only be available once the action has
completed the test run. End-to-end testing can be quite time intensive. Often
times taking <strong>greater than 1 hour</strong>, depending on configuration.</p>
</blockquote>

<h5 id="flat-file">Flat file</h5>

<p>Here’s how to copy the output out as a file:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>juju run-action kubernetes-e2e/0 test
</code></pre>
</div>

<p>Output:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Action queued with id: 4ceed33a-d96d-465a-8f31-20d63442e51b
</code></pre>
</div>

<p>Copy output to your local machine</p>

<div class="highlighter-rouge"><pre class="highlight"><code>juju scp kubernetes-e2e/0:4ceed33a-d96d-465a-8f31-20d63442e51b.log .
</code></pre>
</div>

<h5 id="action-result-output">Action result output</h5>

<p>Or you can just show the output inline::</p>

<div class="highlighter-rouge"><pre class="highlight"><code>juju run-action kubernetes-e2e/0 test
</code></pre>
</div>

<p>Output:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>Action queued with id: 4ceed33a-d96d-465a-8f31-20d63442e51b
</code></pre>
</div>

<p>Show the results in your terminal:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>juju show-action-output 4ceed33a-d96d-465a-8f31-20d63442e51b
</code></pre>
</div>

<h3 id="known-issues">Known issues</h3>

<p>The e2e test suite assumes egress network access. It will pull container
images from <code class="highlighter-rouge">gcr.io</code>. You will need to have this registry unblocked in your
firewall to successfully run e2e test results. Or you may use the exposed
proxy settings <a href="https://github.com/juju-solutions/bundle-canonical-kubernetes#proxy-configuration">properly configured</a>
on the kubernetes-worker units.</p>

<h2 id="upgrading-the-e2e-tests">Upgrading the e2e tests</h2>

<p>The e2e tests are always expanding, you can see if there’s an upgrade available by running <code class="highlighter-rouge">juju status kubernetes-e2e</code>.</p>

<p>When an upgrade is available, upgrade your deployment:</p>

<div class="highlighter-rouge"><pre class="highlight"><code>juju upgrade-charm kubernetes-e2e
</code></pre>
</div>



        <p><a href=""><img src="https://kubernetes-site.appspot.com/UA-36037335-10/GitHub/docs/getting-started-guides/ubuntu/validation.md?pixel" alt="Analytics" /></a>
        
		<script type="text/javascript">
	        PDRTJS_settings_8345992 = {
		        "id" : "8345992",
		        "unique_id" : "/docs/getting-started-guides/ubuntu/validation/",
		        "title" : "Validation",
		        "permalink" : "http://kubernetes.github.io/docs/getting-started-guides/ubuntu/validation/"
	        };
	        (function(d,c,j){if(!document.getElementById(j)){var pd=d.createElement(c),s;pd.id=j;pd.src=('https:'==document.location.protocol)?'https://polldaddy.com/js/rating/rating.js':'http://i0.poll.fm/js/rating/rating.js';s=document.getElementsByTagName(c)[0];s.parentNode.insertBefore(pd,s);}}(document,'script','pd-rating-js'));
		</script>
		<a href="" onclick="window.open('https://github.com/kubernetes/kubernetes.github.io/issues/new?title=Issue%20with%20' +
		window.location.pathname)" class="button issue">Create an Issue</a>
		<a href="/editdocs#docs/getting-started-guides/ubuntu/validation.md" class="button issue">Edit this Page</a>
	
	</div>
</section>

<footer>
	<main class="light-text">
		<nav>
			<a href="/docs/hellonode/">Get Started</a>
			<a href="/docs/">Documentation</a>
			<a href="http://blog.kubernetes.io/">Blog</a>
			<a href="/partners/">Partners</a>
			<a href="/community/">Community</a>
			<a href="/case-studies/">Case Studies</a>
		</nav>
		<div class="social">
			<div>
				<a href="https://twitter.com/kubernetesio" class="twitter"><span>twitter</span></a>
				<a href="https://github.com/kubernetes/kubernetes" class="github"><span>Github</span></a>
				<a href="http://slack.k8s.io/" class="slack"><span>Slack</span></a>
			</div>
			<div>
				<a href="http://stackoverflow.com/questions/tagged/kubernetes" class="stack-overflow"><span>Stack Overflow</span></a>
				<a href="https://groups.google.com/forum/#!forum/kubernetes-users" class="mailing-list"><span>Mailing List</span></a>
				<a href="https://calendar.google.com/calendar/embed?src=nt2tcnbtbied3l6gi2h29slvc0%40group.calendar.google.com" class="calendar"><span>Events Calendar</span></a>
			</div>
			<div>
				<a href="//get.k8s.io" class="button">Download K8s</a>
				<a href="https://github.com/kubernetes/kubernetes" class="button">Contribute to the K8s codebase</a>
			</div>
		</div>
		<div id="miceType" class="center">
			&copy; 2017 The Kubernetes Authors | Documentation Distributed under <a href="https://github.com/kubernetes/kubernetes.github.io/blob/master/LICENSE" class="light-text">CC BY 4.0</a>
		</div>
		<div id="miceType" class="center">
			Copyright &copy; 2017 The Linux Foundation&reg;. All rights reserved. The Linux Foundation has registered trademarks and uses trademarks. For a list of trademarks of The Linux Foundation, please see our Trademark Usage page: <a href="https://www.linuxfoundation.org/trademark-usage" class="light-text">https://www.linuxfoundation.org/trademark-usage</a>
		</div>
	</main>
</footer>

<button class="flyout-button" onclick="kub.toggleToc()"></button>

<style>
.cse .gsc-control-cse, .gsc-control-cse, {
    padding: 0;
}
  .gsc-control-cse table, .gsc-control-cse-en table {
      margin:0px !important;
  }
  .gsc-above-wrapper-area {
      border-bottom: 0;
  }
</style>

<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-36037335-10', 'auto');
ga('send', 'pageview');

// hide docs nav area if no nav is present, or if nav only contains a link to the current page
(function () {
    window.addEventListener('DOMContentLoaded', init)

        // play nice with our neighbors
        function init() {
            window.removeEventListener('DOMContentLoaded', init)
                hideNav()
        }

    function hideNav(toc){
        if (!toc) toc = document.querySelector('#docsToc')
            var container = toc.querySelector('.container')

                // container is built dynamically, so it may not be present on the first runloop
                if (container) {
                    if (container.childElementCount === 0 || toc.querySelectorAll('a.item').length === 1) {
                        toc.style.display = 'none'
                            document.getElementById('docsContent').style.width = '100%'
                    }
                } else {
                    requestAnimationFrame(function () {
                        hideNav(toc)
                    })
                }
    }
})();
</script>

<!-- Commenting out AnswerDash for now; we need to work on our list of questions/answers/design first
    <!-- Start of AnswerDash script <script>var AnswerDash;!function(e,t,n,s,a){if(!t.getElementById(s)){var i,r=t.createElement(n),c=t.getElementsByTagName(n)[0];e[a]||(i=e[a]=function(){i.__oninit.push(arguments)},i.__oninit=[]),r.type="text/javascript",r.async=!0,r.src="https://p1.answerdash.com/answerdash.min.js?siteid=756",r.setAttribute("id",s),c.parentNode.insertBefore(r,c)}}(window,document,"script","answerdash-script","AnswerDash");</script> <!-- End of AnswerDash script -->


</body>
</html>
